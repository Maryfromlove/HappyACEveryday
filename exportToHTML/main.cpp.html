<html>
<head>
    <title>main.cpp</title>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
    <style type="text/css">
        .s0 {
            color: #969896;
        }

        .s1 {
            color: #333333;
        }

        .s2 {
            color: #a71d5d;
        }

        .s3 {
            color: #183691;
        }

        .s4 {
            color: #63a35c;
        }

        .s5 {
            color: #0086b3;
        }
    </style>
</head>
<body bgcolor="#ffffff">
<table BGCOLOR="#c0c0c0" CELLPADDING=5 CELLSPACING=0 COLS=1 WIDTH="100%">
    <tr>
        <td>
            <center>
                <font color="#000000" face="Arial, Helvetica">
                    main.cpp</font>
            </center>
        </td>
    </tr>
</table>
<pre><span class="s0">/* 
*  https://codeforc.es/problemset/problem/750/E 
* 
*/</span>
<span class="s0">//#include &lt;bits/stdc++.h&gt;</span>
<span class="s2">#include </span><span class="s3">&lt;iostream&gt;</span>
<span class="s2">#include </span><span class="s3">&lt;algorithm&gt;</span>
<span class="s2">#include </span><span class="s3">&lt;vector&gt;</span>
<span class="s2">#include </span><span class="s3">&lt;string.h&gt;</span>
<span class="s2">#include </span><span class="s3">&lt;tuple&gt;</span>

<span class="s2">#define  </span><span class="s1">_debug</span><span class="s4">(</span><span class="s1">x</span><span
            class="s4">) </span><span class="s1">cerr</span><span class="s2">&lt;&lt;#</span><span
            class="s1">x</span><span class="s2">&lt;&lt;</span><span class="s3">&quot; = &quot;</span><span class="s2">&lt;&lt;</span><span
            class="s1">x</span><span class="s2">&lt;&lt;</span><span class="s1">endl</span>
<span class="s2">using namespace </span><span class="s1">std</span><span class="s4">;</span>
<span class="s2">typedef long long </span><span class="s1">ll</span><span class="s4">;</span>
<span class="s2">const int </span><span class="s1">MAXN </span><span class="s2">= </span><span
            class="s5">1e5 </span><span class="s2">+ </span><span class="s5">59</span><span class="s4">;</span>
<span class="s2">const int </span><span class="s1">MAXM </span><span class="s2">= </span><span
            class="s5">2e5 </span><span class="s2">+ </span><span class="s5">59</span><span class="s4">;</span>
<span class="s2">const </span><span class="s1">ll MOD </span><span class="s2">= </span><span class="s5">998244353</span><span
            class="s4">;</span>
<span class="s2">const </span><span class="s1">ll INF </span><span class="s2">= </span><span
            class="s5">0x0f0f0f0f</span><span class="s4">;</span>

<span class="s2">int </span><span class="s1">fa</span><span class="s4">[</span><span class="s1">MAXN</span><span
            class="s4">];</span>
<span class="s2">int </span><span class="s1">sz</span><span class="s4">[</span><span class="s1">MAXN</span><span
            class="s4">];</span>

<span class="s2">int </span><span class="s1">findf</span><span class="s4">(</span><span class="s2">int </span><span
            class="s1">x</span><span class="s4">) {</span>
    <span class="s2">if </span><span class="s4">(</span><span class="s1">x </span><span class="s2">== </span><span
            class="s1">fa</span><span class="s4">[</span><span class="s1">x</span><span class="s4">])</span><span
            class="s2">return </span><span class="s1">x</span><span class="s4">;</span>
    <span class="s2">else </span><span class="s4">{</span>
        <span class="s1">sz</span><span class="s4">[</span><span class="s1">fa</span><span class="s4">[</span><span
            class="s1">x</span><span class="s4">]] </span><span class="s2">+= </span><span class="s1">sz</span><span
            class="s4">[</span><span class="s1">x</span><span class="s4">];</span>
        <span class="s1">sz</span><span class="s4">[</span><span class="s1">x</span><span class="s4">] </span><span
            class="s2">= </span><span class="s5">0</span><span class="s4">;</span>
        <span class="s2">return </span><span class="s1">fa</span><span class="s4">[</span><span class="s1">x</span><span
            class="s4">] </span><span class="s2">= </span><span class="s1">findf</span><span class="s4">(</span><span
            class="s1">fa</span><span class="s4">[</span><span class="s1">x</span><span class="s4">]);</span>
    <span class="s4">}</span>
<span class="s4">}</span>

<span class="s2">void </span><span class="s1">mergf</span><span class="s4">(</span><span class="s2">int </span><span
            class="s1">x</span><span class="s4">, </span><span class="s2">int </span><span class="s1">y</span><span
            class="s4">) {</span>
    <span class="s2">int </span><span class="s1">fx </span><span class="s2">= </span><span class="s1">findf</span><span
            class="s4">(</span><span class="s1">x</span><span class="s4">);</span>
    <span class="s2">int </span><span class="s1">fy </span><span class="s2">= </span><span class="s1">findf</span><span
            class="s4">(</span><span class="s1">y</span><span class="s4">);</span>
    <span class="s2">if </span><span class="s4">(</span><span class="s1">fx </span><span class="s2">== </span><span
            class="s1">fy</span><span class="s4">)</span><span class="s2">return</span><span class="s4">;</span>
    <span class="s2">if </span><span class="s4">(</span><span class="s1">sz</span><span class="s4">[</span><span
            class="s1">fx</span><span class="s4">] </span><span class="s2">&lt;= </span><span class="s1">sz</span><span
            class="s4">[</span><span class="s1">fy</span><span class="s4">]) {</span>
        <span class="s1">sz</span><span class="s4">[</span><span class="s1">fx</span><span class="s4">] </span><span
            class="s2">+= </span><span class="s1">sz</span><span class="s4">[</span><span class="s1">fy</span><span
            class="s4">];</span>
        <span class="s1">sz</span><span class="s4">[</span><span class="s1">fy</span><span class="s4">] </span><span
            class="s2">= </span><span class="s5">0</span><span class="s4">;</span>
        <span class="s1">fa</span><span class="s4">[</span><span class="s1">fy</span><span class="s4">] </span><span
            class="s2">= </span><span class="s1">fx</span><span class="s4">;</span>
    <span class="s4">} </span><span class="s2">else </span><span class="s4">{</span>
        <span class="s1">sz</span><span class="s4">[</span><span class="s1">fy</span><span class="s4">] </span><span
            class="s2">+= </span><span class="s1">sz</span><span class="s4">[</span><span class="s1">fx</span><span
            class="s4">];</span>
        <span class="s1">sz</span><span class="s4">[</span><span class="s1">fx</span><span class="s4">] </span><span
            class="s2">= </span><span class="s5">0</span><span class="s4">;</span>
        <span class="s1">fa</span><span class="s4">[</span><span class="s1">fx</span><span class="s4">] </span><span
            class="s2">= </span><span class="s1">fy</span><span class="s4">;</span>
    <span class="s4">}</span>
<span class="s4">}</span>


<span class="s2">int </span><span class="s1">Kase</span><span class="s4">;</span>
<span class="s2">int </span><span class="s1">n</span><span class="s4">, </span><span class="s1">m</span><span
            class="s4">, </span><span class="s1">k</span><span class="s4">;</span>
<span class="s1">pair</span><span class="s2">&lt;int</span><span class="s4">, </span><span
            class="s2">int&gt; </span><span class="s1">e</span><span class="s4">[</span><span
            class="s1">MAXM</span><span class="s4">];</span>
<span class="s2">int </span><span class="s1">a</span><span class="s4">[</span><span class="s1">MAXN</span><span
            class="s4">];</span>
<span class="s2">bool </span><span class="s1">tag</span><span class="s4">[</span><span class="s1">MAXN</span><span
            class="s4">];</span>
<span class="s2">bool </span><span class="s1">vis</span><span class="s4">[</span><span class="s1">MAXN</span><span
            class="s4">];</span>
<span class="s1">vector</span><span class="s2">&lt;int&gt; </span><span class="s1">g</span><span
            class="s4">[</span><span class="s1">MAXN</span><span class="s4">];</span>

<span class="s2">int </span><span class="s1">main</span><span class="s4">() {</span>
    <span class="s1">ios_base</span><span class="s2">::</span><span class="s1">sync_with_stdio</span><span
            class="s4">(</span><span class="s2">false</span><span class="s4">);</span>
    <span class="s1">cin</span><span class="s4">.</span><span class="s1">tie</span><span class="s4">(</span><span
            class="s2">nullptr</span><span class="s4">);</span>

    <span class="s1">cin </span><span class="s2">&gt;&gt; </span><span class="s1">Kase</span><span class="s4">;</span>
    <span class="s2">while </span><span class="s4">(</span><span class="s1">Kase</span><span class="s2">--</span><span
            class="s4">) {</span>
        <span class="s1">cin </span><span class="s2">&gt;&gt; </span><span class="s1">n </span><span
            class="s2">&gt;&gt; </span><span class="s1">m </span><span class="s2">&gt;&gt; </span><span
            class="s1">k</span><span class="s4">;</span>
        <span class="s2">for </span><span class="s4">(</span><span class="s2">int </span><span class="s1">i </span><span
            class="s2">= </span><span class="s5">1</span><span class="s4">; </span><span class="s1">i </span><span
            class="s2">&lt;= </span><span class="s1">n</span><span class="s4">; </span><span class="s2">++</span><span
            class="s1">i</span><span class="s4">) {</span>
            <span class="s1">fa</span><span class="s4">[</span><span class="s1">i</span><span class="s4">] </span><span
            class="s2">= </span><span class="s1">i</span><span class="s4">;</span>
            <span class="s1">sz</span><span class="s4">[</span><span class="s1">i</span><span class="s4">] </span><span
            class="s2">= </span><span class="s5">1</span><span class="s4">;</span>
            <span class="s1">tag</span><span class="s4">[</span><span class="s1">i</span><span class="s4">] </span><span
            class="s2">= false</span><span class="s4">;</span>
            <span class="s1">vis</span><span class="s4">[</span><span class="s1">i</span><span class="s4">] </span><span
            class="s2">= false</span><span class="s4">;</span>
            <span class="s1">g</span><span class="s4">[</span><span class="s1">i</span><span class="s4">].</span><span
            class="s1">clear</span><span class="s4">();</span>
        <span class="s4">}</span>
        <span class="s2">for </span><span class="s4">(</span><span class="s2">int </span><span class="s1">i </span><span
            class="s2">= </span><span class="s5">1</span><span class="s4">; </span><span class="s1">i </span><span
            class="s2">&lt;= </span><span class="s1">m</span><span class="s4">; </span><span class="s2">++</span><span
            class="s1">i</span><span class="s4">) {</span>
            <span class="s1">cin </span><span class="s2">&gt;&gt; </span><span class="s1">e</span><span
            class="s4">[</span><span class="s1">i</span><span class="s4">].</span><span class="s1">first </span><span
            class="s2">&gt;&gt; </span><span class="s1">e</span><span class="s4">[</span><span class="s1">i</span><span
            class="s4">].</span><span class="s1">second</span><span class="s4">;</span>
        <span class="s4">}</span>
        <span class="s2">for </span><span class="s4">(</span><span class="s2">int </span><span class="s1">i </span><span
            class="s2">= </span><span class="s5">1</span><span class="s4">; </span><span class="s1">i </span><span
            class="s2">&lt;= </span><span class="s1">k</span><span class="s4">; </span><span class="s2">++</span><span
            class="s1">i</span><span class="s4">) {</span>
            <span class="s1">cin </span><span class="s2">&gt;&gt; </span><span class="s1">a</span><span
            class="s4">[</span><span class="s1">i</span><span class="s4">];</span>
            <span class="s1">tag</span><span class="s4">[</span><span class="s1">a</span><span class="s4">[</span><span
            class="s1">i</span><span class="s4">]] </span><span class="s2">= true</span><span class="s4">;</span>
            <span class="s1">sz</span><span class="s4">[</span><span class="s1">a</span><span class="s4">[</span><span
            class="s1">i</span><span class="s4">]] </span><span class="s2">= </span><span class="s5">0</span><span
            class="s4">;</span>
        <span class="s4">}</span>
        <span class="s2">for </span><span class="s4">(</span><span class="s2">int </span><span class="s1">i </span><span
            class="s2">= </span><span class="s5">1</span><span class="s4">; </span><span class="s1">i </span><span
            class="s2">&lt;= </span><span class="s1">m</span><span class="s4">; </span><span class="s2">++</span><span
            class="s1">i</span><span class="s4">) {</span>
            <span class="s2">if </span><span class="s4">(</span><span class="s1">tag</span><span
            class="s4">[</span><span class="s1">e</span><span class="s4">[</span><span class="s1">i</span><span
            class="s4">].</span><span class="s1">first</span><span class="s4">] </span><span class="s2">== </span><span
            class="s5">0 </span><span class="s2">&amp;&amp; </span><span class="s1">tag</span><span
            class="s4">[</span><span class="s1">e</span><span class="s4">[</span><span class="s1">i</span><span
            class="s4">].</span><span class="s1">second</span><span class="s4">] </span><span class="s2">== </span><span
            class="s5">0</span><span class="s4">) {</span>
                <span class="s1">mergf</span><span class="s4">(</span><span class="s1">e</span><span class="s4">[</span><span
            class="s1">i</span><span class="s4">].</span><span class="s1">first</span><span class="s4">, </span><span
            class="s1">e</span><span class="s4">[</span><span class="s1">i</span><span class="s4">].</span><span
            class="s1">second</span><span class="s4">);</span>
            <span class="s4">}</span>
        <span class="s4">}</span>
        <span class="s2">for </span><span class="s4">(</span><span class="s2">int </span><span class="s1">u</span><span
            class="s4">, </span><span class="s1">v</span><span class="s4">, </span><span class="s1">i </span><span
            class="s2">= </span><span class="s5">1</span><span class="s4">; </span><span class="s1">i </span><span
            class="s2">&lt;= </span><span class="s1">m</span><span class="s4">; </span><span class="s2">++</span><span
            class="s1">i</span><span class="s4">) {</span>
            <span class="s1">tie</span><span class="s4">(</span><span class="s1">u</span><span class="s4">, </span><span
            class="s1">v</span><span class="s4">) </span><span class="s2">= </span><span class="s1">e</span><span
            class="s4">[</span><span class="s1">i</span><span class="s4">];</span>

            <span class="s1">v </span><span class="s2">= </span><span class="s1">findf</span><span
            class="s4">(</span><span class="s1">v</span><span class="s4">);</span>
            <span class="s1">u </span><span class="s2">= </span><span class="s1">findf</span><span
            class="s4">(</span><span class="s1">u</span><span class="s4">);</span>

            <span class="s2">if </span><span class="s4">(</span><span class="s1">tag</span><span
            class="s4">[</span><span class="s1">u</span><span class="s4">] </span><span class="s2">|| </span><span
            class="s1">tag</span><span class="s4">[</span><span class="s1">v</span><span class="s4">]) {</span>
                <span class="s1">g</span><span class="s4">[</span><span class="s1">u</span><span
            class="s4">].</span><span class="s1">emplace_back</span><span class="s4">(</span><span
            class="s1">v</span><span class="s4">);</span>
                <span class="s1">g</span><span class="s4">[</span><span class="s1">v</span><span
            class="s4">].</span><span class="s1">emplace_back</span><span class="s4">(</span><span
            class="s1">u</span><span class="s4">);</span>
            <span class="s4">}</span>
        <span class="s4">}</span>

        <span class="s2">int </span><span class="s1">start </span><span class="s2">= </span><span
            class="s1">findf</span><span class="s4">(</span><span class="s5">1</span><span class="s4">);</span>
        <span class="s2">double </span><span class="s1">ans </span><span class="s2">= </span><span
            class="s1">sz</span><span class="s4">[</span><span class="s1">start</span><span class="s4">];</span>
        <span class="s2">double </span><span class="s1">tmp </span><span class="s2">= </span><span
            class="s5">0</span><span class="s4">;</span>

        <span class="s2">for </span><span class="s4">(</span><span class="s2">auto </span><span class="s1">u</span><span
            class="s2">:</span><span class="s1">g</span><span class="s4">[</span><span class="s1">start</span><span
            class="s4">]) {</span>
            <span class="s2">if </span><span class="s4">(</span><span class="s1">vis</span><span
            class="s4">[</span><span class="s1">u</span><span class="s4">])</span><span class="s2">continue</span><span
            class="s4">;</span>
            <span class="s2">else </span><span class="s1">vis</span><span class="s4">[</span><span
            class="s1">u</span><span class="s4">] </span><span class="s2">= true</span><span class="s4">;</span>

            <span class="s2">double </span><span class="s1">sum </span><span class="s2">= </span><span
            class="s5">0</span><span class="s4">;</span>
            <span class="s2">for </span><span class="s4">(</span><span class="s2">auto </span><span
            class="s1">v</span><span class="s2">:</span><span class="s1">g</span><span class="s4">[</span><span
            class="s1">u</span><span class="s4">])</span><span class="s2">if </span><span class="s4">(</span><span
            class="s1">v </span><span class="s2">!= </span><span class="s1">start</span><span class="s4">)</span><span
            class="s1">sum </span><span class="s2">+= </span><span class="s1">sz</span><span class="s4">[</span><span
            class="s1">v</span><span class="s4">];</span>
            <span class="s1">sum </span><span class="s2">/= </span><span class="s5">1.0 </span><span
            class="s2">* </span><span class="s1">g</span><span class="s4">[</span><span class="s1">u</span><span
            class="s4">].</span><span class="s1">size</span><span class="s4">();</span>

            <span class="s2">if </span><span class="s4">(</span><span class="s1">sum </span><span
            class="s2">&gt; </span><span class="s1">tmp</span><span class="s4">) </span><span
            class="s1">tmp </span><span class="s2">= </span><span class="s1">sum</span><span class="s4">;</span>
        <span class="s4">}</span>
        <span class="s1">ans </span><span class="s2">+= </span><span class="s1">tmp</span><span class="s4">;</span>
        <span class="s1">printf</span><span class="s4">(</span><span class="s3">&quot;%.6f\n&quot;</span><span
            class="s4">, </span><span class="s1">ans</span><span class="s4">);</span>
    <span class="s4">}</span>

    <span class="s2">return </span><span class="s5">0</span><span class="s4">;</span>
<span class="s4">}</span></pre>
</body>
</html>